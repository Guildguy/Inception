FROM alpine:3.21

RUN apk update && apk upgrade && \
    apk add --no-cache \
    mariadb mariadb-client

RUN sed -i "s/skip-networking/# skip-networking/g" /etc/my.cnf.d/mariadb-server.cnf

RUN printf "[mysqld]\nbind-address = 0.0.0.0\n" > /etc/my.cnf.d/docker-network.cnf

COPY ./tools/entrypoint.sh /entrypoint.sh

RUN chmod +x /entrypoint.sh

EXPOSE 3306

CMD ["/entrypoint.sh"]